<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ’¼ Sistema Gestor Financiero - VersiÃ³n Migrada ğŸ”„</title>
    
    <!-- ğŸ¨ Estilos principales -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/ventanas.css">
    <link rel="stylesheet" href="css/alertas.css">
    
    <style>
        .migration-banner {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            margin-bottom: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .system-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .status-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-left: 4px solid #667eea;
        }
        
        .status-card h3 {
            margin: 0 0 10px 0;
            color: #333;
            font-size: 16px;
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-success { background-color: #4CAF50; }
        .status-warning { background-color: #FF9800; }
        .status-error { background-color: #F44336; }
        .status-info { background-color: #2196F3; }
        
        .metrics-display {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            font-family: 'Courier New', monospace;
            font-size: 14px;
        }
        
        .dev-controls {
            position: fixed;
            top: 20px;
            right: 20px;
            background: white;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            border: 2px solid #667eea;
            z-index: 1000;
        }
        
        .dev-controls button {
            display: block;
            width: 100%;
            margin: 5px 0;
            padding: 8px 12px;
            border: none;
            border-radius: 5px;
            background: #667eea;
            color: white;
            cursor: pointer;
            font-size: 12px;
        }
        
        .dev-controls button:hover {
            background: #5a67d8;
        }
    </style>
</head>
<body>
    <!-- ğŸš€ Banner de VersiÃ³n Migrada -->
    <div class="migration-banner">
        ğŸ”„ VERSIÃ“N MIGRADA - Sistema con Arquitectura Refactorizada (Sin ES6 Modules)
        <br><small>Cargando sistemas core directamente</small>
    </div>

    <!-- ğŸ® Controles de Desarrollo -->
    <div class="dev-controls">
        <h4 style="margin: 0 0 10px 0; color: #333;">ğŸ› ï¸ Dev Tools</h4>
        <button onclick="initMigratedApp()">ğŸš€ Inicializar App</button>
        <button onclick="showMetrics()">ğŸ“Š Ver MÃ©tricas</button>
        <button onclick="showState()">ğŸ” Ver Estado</button>
        <button onclick="testSystems()">ğŸ§ª Test Sistemas</button>
        <button onclick="testStorage()">ğŸ“¦ Test Storage</button>
        <button onclick="clearCache()">ğŸ—‘ï¸ Limpiar CachÃ©</button>
        <button onclick="runTests()">ğŸ§ª Ejecutar Tests</button>
    </div>

    <!-- ğŸ“Š Estado de Sistemas -->
    <div class="container">
        <h1>ğŸ’¼ Sistema de GestiÃ³n Financiera Personal</h1>
        <h2>ğŸ”„ VersiÃ³n Migrada con Nuevos Sistemas Core</h2>
        
        <div id="systemStatus" class="system-status">
            <!-- Se llena dinÃ¡micamente -->
        </div>
        
        <div id="metricsDisplay" class="metrics-display" style="display: none;">
            <!-- MÃ©tricas en tiempo real -->
        </div>
        
        <!-- ğŸ“± Interfaz principal de la aplicaciÃ³n -->
        <div id="appContainer">
            <div style="text-align: center; padding: 50px; color: #666;">
                <h3>ğŸš€ Presiona "Inicializar App" para comenzar</h3>
                <p>La aplicaciÃ³n migrada utiliza los nuevos sistemas core para mejor rendimiento y mantenibilidad.</p>
            </div>
        </div>
    </div>

    <!-- ğŸ”§ Cargar sistemas core directamente (sin ES6 modules) -->
    <script src="js/core/DependencyInjector.js"></script>
    <script src="js/core/EventBus.js"></script>
    <script src="js/core/ValidationSystem.js"></script>
    <script src="js/core/MetricsSystem.js"></script>
    <script src="js/core/CacheSystem.js"></script>
    <script src="js/modules/logger.js"></script>
    
    <!-- ğŸ“¦ Cargar StorageManager migrado -->
    <script src="js/core/StorageManagerMigrated.js"></script>
    
    <!-- ğŸ”§ Forzar disponibilidad del Logger -->
    <script>
        // Verificar y crear Logger si no existe
        if (!window.Logger) {
            console.warn('âš ï¸ Logger no se cargÃ³ correctamente, creando versiÃ³n simple');
            window.Logger = class SimpleLogger {
                constructor() {
                    this.isDev = true;
                }
                info(msg, ...args) { console.log(`â„¹ï¸ ${msg}`, ...args); }
                success(msg, ...args) { console.log(`âœ… ${msg}`, ...args); }
                error(msg, ...args) { console.error(`âŒ ${msg}`, ...args); }
                warn(msg, ...args) { console.warn(`âš ï¸ ${msg}`, ...args); }
                debug(msg, ...args) { console.debug(`ğŸ” ${msg}`, ...args); }
            };
        }
        
        console.log('ğŸ”§ VerificaciÃ³n de sistemas core completada');
    </script>
    
    <script>
        // ğŸš€ VersiÃ³n simplificada del GestorFinancieroMigrado
        class GestorFinancieroMigrado {
            constructor() {
                // Usar las instancias globales existentes en lugar de crear nuevas
                this.di = window.DI || new DependencyInjector();
                this.eventBus = window.EventBus;
                this.logger = this.createLogger();
                this.validation = window.ValidationSystem;
                this.metrics = window.MetricsSystem;
                this.cache = window.CacheSystem;
                
                this.initializeCoreServices();
                
                this.state = {
                    isInitialized: false,
                    currentView: 'dashboard',
                    userData: null,
                    settings: {}
                };
                
                this.regionConfig = {
                    currency: 'MXN',
                    locale: 'es-MX',
                    timeZone: 'America/Mexico_City'
                };
            }

            /**
             * ğŸ”§ Crear Logger (con respaldo si no estÃ¡ disponible)
             */
            createLogger() {
                if (window.Logger) {
                    return new window.Logger();
                }
                
                // Logger simple de respaldo
                return {
                    info: (msg, ...args) => console.log(`â„¹ï¸ ${msg}`, ...args),
                    success: (msg, ...args) => console.log(`âœ… ${msg}`, ...args),
                    error: (msg, ...args) => console.error(`âŒ ${msg}`, ...args),
                    warn: (msg, ...args) => console.warn(`âš ï¸ ${msg}`, ...args),
                    debug: (msg, ...args) => console.debug(`ğŸ” ${msg}`, ...args)
                };
            }

            initializeCoreServices() {
                // Si ya tenemos las instancias globales, las registramos en DI
                if (this.eventBus) this.di.register('eventBus', () => this.eventBus, true);
                if (this.logger) this.di.register('logger', () => this.logger, true);
                if (this.validation) this.di.register('validation', () => this.validation, true);
                if (this.metrics) this.di.register('metrics', () => this.metrics, true);
                if (this.cache) this.di.register('cache', () => this.cache, true);
                
                // ğŸ“¦ Crear StorageManager migrado
                if (window.StorageManagerMigrated) {
                    this.storage = new window.StorageManagerMigrated(this.di);
                    this.di.register('storage', () => this.storage, true);
                }
            }

            async init() {
                try {
                    // Verificar que los sistemas core estÃ©n disponibles
                    if (!this.checkCoreSystemsAvailable()) {
                        throw new Error('No todos los sistemas core estÃ¡n disponibles');
                    }
                    
                    const logger = this.logger || console;
                    const metrics = this.metrics;
                    const eventBus = this.eventBus;
                    
                    if (logger.info) {
                        logger.info('ğŸš€ Iniciando Sistema de GestiÃ³n Financiera Personal - VersiÃ³n Migrada');
                    } else {
                        console.log('ğŸš€ Iniciando Sistema de GestiÃ³n Financiera Personal - VersiÃ³n Migrada');
                    }
                    
                    if (metrics && metrics.recordMetric) {
                        metrics.recordMetric('app.initialization.started', 1);
                    }
                    const startTime = performance.now();
                    
                    this.setupGlobalEvents();
                    await this.configurarFormatoMexicano();
                    
                    // ğŸ“¦ Inicializar StorageManager migrado
                    if (this.storage) {
                        await this.storage.init();
                        if (logger.success) {
                            logger.success('âœ… StorageManager migrado inicializado');
                        }
                    }
                    
                    await this.cargarDatosUsuario();
                    
                    this.state.isInitialized = true;
                    
                    const initTime = performance.now() - startTime;
                    if (metrics && metrics.recordMetric) {
                        metrics.recordMetric('app.initialization.completed', 1);
                        metrics.recordMetric('app.initialization.time', initTime);
                    }
                    
                    if (eventBus && eventBus.emit) {
                        eventBus.emit('app:ready', {
                            initTime,
                            version: '2.0.0-migrated-simple',
                            region: this.regionConfig
                        });
                    }
                    
                    if (logger.success) {
                        logger.success(`âœ… AplicaciÃ³n inicializada correctamente en ${initTime.toFixed(2)}ms`);
                    } else {
                        console.log(`âœ… AplicaciÃ³n inicializada correctamente en ${initTime.toFixed(2)}ms`);
                    }
                    
                } catch (error) {
                    console.error('âŒ Error durante la inicializaciÃ³n:', error);
                    throw error;
                }
            }

            /**
             * âœ… Verificar que los sistemas core estÃ©n disponibles
             */
            checkCoreSystemsAvailable() {
                const systems = {
                    'DI': window.DI,
                    'EventBus': window.EventBus,
                    'ValidationSystem': window.ValidationSystem,
                    'MetricsSystem': window.MetricsSystem,
                    'CacheSystem': window.CacheSystem
                };
                
                let allAvailable = true;
                let availableCount = 0;
                
                for (const [name, system] of Object.entries(systems)) {
                    if (!system) {
                        console.warn(`âš ï¸ Sistema ${name} no estÃ¡ disponible`);
                        allAvailable = false;
                    } else {
                        console.log(`âœ… Sistema ${name} disponible`);
                        availableCount++;
                    }
                }
                
                // Logger es opcional
                if (window.Logger) {
                    console.log(`âœ… Sistema Logger disponible`);
                } else {
                    console.log(`âš ï¸ Sistema Logger no disponible (opcional - usando console)`);
                }
                
                // Consideramos exitoso si tenemos al menos los 5 sistemas principales
                const success = availableCount >= 5;
                console.log(`ğŸ“Š Sistemas disponibles: ${availableCount}/5 requeridos`);
                
                return success;
            }

            /**
             * ğŸŒ Configurar formato y localizaciÃ³n para MÃ©xico
             */
            async configurarFormatoMexicano() {
                const cache = this.cache;
                
                let config = null;
                if (cache) {
                    config = await cache.get('locale.config.mx');
                }
                
                if (!config) {
                    config = {
                        currency: { code: 'MXN', symbol: '$' },
                        number: { locale: 'es-MX' },
                        date: { locale: 'es-MX', timeZone: 'America/Mexico_City' }
                    };
                    
                    if (cache) {
                        await cache.set('locale.config.mx', config, { ttl: 86400000 });
                    }
                }
                
                this.regionConfig = { ...this.regionConfig, ...config };
                
                window.formatCurrency = (amount) => {
                    return new Intl.NumberFormat('es-MX', {
                        style: 'currency',
                        currency: 'MXN'
                    }).format(amount);
                };
                
                window.formatNumber = (number) => {
                    return new Intl.NumberFormat('es-MX').format(number);
                };
            }

            /**
             * ğŸ”„ Cargar datos del usuario desde StorageManager migrado
             */
            async cargarDatosUsuario() {
                const logger = this.logger || console;
                
                try {
                    if (!this.storage) {
                        if (logger.warn) {
                            logger.warn('âš ï¸ StorageManager no disponible, saltando carga de datos');
                        }
                        return;
                    }
                    
                    // ğŸ“¥ Cargar datos usando StorageManager migrado
                    const ingresos = await this.storage.getIngresos();
                    const gastos = await this.storage.getGastos();
                    const configuracion = await this.storage.getConfiguracion();
                    const categorias = await this.storage.getCategorias();
                    
                    this.state.userData = {
                        ingresos: ingresos || [],
                        gastos: gastos || [],
                        configuracion: configuracion || {},
                        categorias: categorias || {},
                        lastUpdate: new Date().toISOString()
                    };
                    
                    if (logger.info) {
                        logger.info(`ğŸ“Š Datos cargados: ${this.state.userData.ingresos.length} ingresos, ${this.state.userData.gastos.length} gastos`);
                    }
                    
                } catch (error) {
                    if (logger.error) {
                        logger.error('âŒ Error cargando datos de usuario:', error);
                    } else {
                        console.error('âŒ Error cargando datos de usuario:', error);
                    }
                }
            }

            setupGlobalEvents() {
                const eventBus = this.eventBus;
                const logger = this.logger || console;
                
                if (!eventBus || !eventBus.on) return;
                
                eventBus.on('app:error', (error) => {
                    if (logger.error) {
                        logger.error('ğŸš¨ Error de aplicaciÃ³n:', error);
                    } else {
                        console.error('ğŸš¨ Error de aplicaciÃ³n:', error);
                    }
                });
                
                eventBus.on('user:action', (action) => {
                    const metrics = this.metrics;
                    if (metrics && metrics.recordMetric) {
                        metrics.recordMetric('user.action.' + action.type, 1, action.details);
                    }
                });
            }

            getMetrics() {
                const metrics = this.metrics;
                if (metrics && metrics.getMetricsSummary) {
                    return metrics.getMetricsSummary();
                }
                
                return { 
                    message: 'Metrics not available',
                    timestamp: new Date().toISOString(),
                    status: 'disabled'
                };
            }

            getState() {
                return {
                    ...this.state,
                    metrics: this.getMetrics(),
                    timestamp: new Date().toISOString()
                };
            }
        }
        
        // ğŸŒ Variables globales
        window.GestorFinancieroMigrado = GestorFinancieroMigrado;
        window.migratedApp = null;
        window.debugMode = true;
        
        /**
         * ğŸš€ Inicializar aplicaciÃ³n migrada
         */
        async function initMigratedApp() {
            try {
                updateSystemStatus('app', 'info', 'Inicializando...');
                
                window.migratedApp = new window.GestorFinancieroMigrado();
                await window.migratedApp.init();
                
                updateSystemStatus('app', 'success', 'Inicializado correctamente');
                updateAllSystemStatus();
                
                document.getElementById('appContainer').innerHTML = `
                    <div style="text-align: center; padding: 30px; background: #e8f5e8; border-radius: 10px;">
                        <h3>âœ… AplicaciÃ³n Migrada Inicializada</h3>
                        <p>Todos los sistemas core estÃ¡n funcionando correctamente.</p>
                        <div style="margin: 20px 0;">
                            <button onclick="showMetrics()" style="margin: 5px; padding: 10px 20px; border: none; background: #667eea; color: white; border-radius: 5px; cursor: pointer;">ğŸ“Š Ver MÃ©tricas</button>
                            <button onclick="showState()" style="margin: 5px; padding: 10px 20px; border: none; background: #667eea; color: white; border-radius: 5px; cursor: pointer;">ğŸ” Ver Estado</button>
                            <button onclick="testSystems()" style="margin: 5px; padding: 10px 20px; border: none; background: #667eea; color: white; border-radius: 5px; cursor: pointer;">ğŸ§ª Test Sistemas</button>
                        </div>
                    </div>
                `;
                
                console.log('ğŸ‰ AplicaciÃ³n migrada inicializada correctamente');
                
            } catch (error) {
                updateSystemStatus('app', 'error', `Error: ${error.message}`);
                console.error('âŒ Error inicializando aplicaciÃ³n migrada:', error);
            }
        }
        
        /**
         * ğŸ“Š Mostrar mÃ©tricas del sistema
         */
        function showMetrics() {
            if (!window.migratedApp) {
                alert('ğŸš¨ Primero debes inicializar la aplicaciÃ³n');
                return;
            }
            
            const metrics = window.migratedApp.getMetrics();
            const display = document.getElementById('metricsDisplay');
            
            display.innerHTML = `
                <h3>ğŸ“Š MÃ©tricas del Sistema</h3>
                <pre>${JSON.stringify(metrics, null, 2)}</pre>
            `;
            display.style.display = 'block';
        }
        
        /**
         * ğŸ” Mostrar estado de la aplicaciÃ³n
         */
        function showState() {
            if (!window.migratedApp) {
                alert('ğŸš¨ Primero debes inicializar la aplicaciÃ³n');
                return;
            }
            
            const state = window.migratedApp.getState();
            const display = document.getElementById('metricsDisplay');
            
            display.innerHTML = `
                <h3>ğŸ” Estado de la AplicaciÃ³n</h3>
                <pre>${JSON.stringify(state, null, 2)}</pre>
            `;
            display.style.display = 'block';
        }
        
        /**
         * ğŸ§ª Probar sistemas individualmente
         */
        async function testSystems() {
            if (!window.migratedApp) {
                alert('ğŸš¨ Primero debes inicializar la aplicaciÃ³n');
                return;
            }
            
            try {
                // ğŸ§ª Test EventBus
                const eventBus = window.migratedApp.eventBus;
                if (eventBus && eventBus.emit) {
                    eventBus.emit('test:event', { message: 'Test desde dev tools' });
                    updateSystemStatus('eventBus', 'success', 'Test exitoso');
                } else {
                    updateSystemStatus('eventBus', 'error', 'EventBus no disponible');
                }
                
                // ğŸ§ª Test Cache
                const cache = window.migratedApp.cache;
                if (cache && cache.set && cache.get) {
                    await cache.set('test:key', 'test:value');
                    const value = await cache.get('test:key');
                    updateSystemStatus('cache', value === 'test:value' ? 'success' : 'error', 
                        value === 'test:value' ? 'Test exitoso' : 'Test fallido');
                } else {
                    updateSystemStatus('cache', 'error', 'Cache no disponible');
                }
                
                // ğŸ§ª Test Validation
                const validation = window.migratedApp.validation;
                if (validation && validation.validateAndSanitize) {
                    const testData = { monto: 100, categoria: 'test' };
                    try {
                        const validated = await validation.validateAndSanitize(testData, 'ingreso');
                        updateSystemStatus('validation', 'success', 'Test exitoso');
                    } catch (e) {
                        updateSystemStatus('validation', 'warning', 'Test con errores: ' + e.message);
                    }
                } else {
                    updateSystemStatus('validation', 'error', 'Validation no disponible');
                }
                
                // ğŸ§ª Test Metrics
                const metrics = window.migratedApp.metrics;
                if (metrics && metrics.recordMetric) {
                    metrics.recordMetric('test.metric', 42);
                    updateSystemStatus('metrics', 'success', 'Test exitoso');
                } else {
                    updateSystemStatus('metrics', 'error', 'Metrics no disponible');
                }
                
                alert('ğŸ‰ Tests de sistemas completados. Revisa el estado.');
                
            } catch (error) {
                console.error('âŒ Error en tests de sistemas:', error);
                alert('ğŸš¨ Error en tests: ' + error.message);
            }
        }
        
        /**
         * ğŸ—‘ï¸ Limpiar cachÃ© del sistema
         */
        async function clearCache() {
            if (!window.migratedApp) {
                alert('ğŸš¨ Primero debes inicializar la aplicaciÃ³n');
                return;
            }
            
            try {
                const cache = window.migratedApp.di.resolve('cache');
                await cache.clear();
                updateSystemStatus('cache', 'info', 'CachÃ© limpiado');
                alert('ğŸ—‘ï¸ CachÃ© limpiado correctamente');
            } catch (error) {
                console.error('âŒ Error limpiando cachÃ©:', error);
                alert('ğŸš¨ Error limpiando cachÃ©: ' + error.message);
            }
        }
        
        /**
         * ğŸ“¦ Probar StorageManager migrado
         */
        async function testStorage() {
            if (!window.migratedApp || !window.migratedApp.storage) {
                alert('ğŸš¨ StorageManager no disponible. Inicializa la aplicaciÃ³n primero.');
                return;
            }
            
            const storage = window.migratedApp.storage;
            const display = document.getElementById('metricsDisplay');
            
            try {
                display.innerHTML = '<h3>ğŸ“¦ Probando StorageManager Migrado...</h3>';
                display.style.display = 'block';
                
                let results = [];
                
                // ğŸ§ª Test 1: Guardar ingreso
                try {
                    const ingreso = {
                        monto: 1500,
                        descripcion: 'Test ingreso desde UI',
                        categoria: 'salario',
                        fecha: new Date().toISOString().split('T')[0]
                    };
                    
                    const saved = await storage.saveIngreso(ingreso);
                    results.push(`âœ… Ingreso guardado: ID ${saved.id}`);
                } catch (e) {
                    results.push(`âŒ Error guardando ingreso: ${e.message}`);
                }
                
                // ğŸ§ª Test 2: Guardar gasto
                try {
                    const gasto = {
                        monto: 500,
                        descripcion: 'Test gasto desde UI',
                        categoria: 'alimentacion',
                        fecha: new Date().toISOString().split('T')[0]
                    };
                    
                    const saved = await storage.saveGasto(gasto);
                    results.push(`âœ… Gasto guardado: ID ${saved.id}`);
                } catch (e) {
                    results.push(`âŒ Error guardando gasto: ${e.message}`);
                }
                
                // ğŸ§ª Test 3: Obtener datos
                try {
                    const ingresos = await storage.getIngresos();
                    const gastos = await storage.getGastos();
                    results.push(`âœ… Datos obtenidos: ${ingresos.length} ingresos, ${gastos.length} gastos`);
                } catch (e) {
                    results.push(`âŒ Error obteniendo datos: ${e.message}`);
                }
                
                // ğŸ§ª Test 4: Health check
                try {
                    const health = await storage.healthCheck();
                    const healthStatus = Object.values(health).every(status => status === 'healthy') ? 'âœ…' : 'âš ï¸';
                    results.push(`${healthStatus} Health check: ${JSON.stringify(health)}`);
                } catch (e) {
                    results.push(`âŒ Error en health check: ${e.message}`);
                }
                
                // ğŸ§ª Test 5: Backup
                try {
                    const backup = await storage.createBackup();
                    results.push(`âœ… Backup creado: ${backup.timestamp}`);
                } catch (e) {
                    results.push(`âŒ Error creando backup: ${e.message}`);
                }
                
                // ğŸ“Š Mostrar resultados
                display.innerHTML = `
                    <h3>ğŸ“¦ Resultados de Tests de StorageManager</h3>
                    <div style="font-family: monospace; white-space: pre-line; line-height: 1.6;">
${results.join('\n')}

ğŸ“Š Stats del Storage:
${JSON.stringify(storage.getStorageStats(), null, 2)}
                    </div>
                `;
                
            } catch (error) {
                display.innerHTML = `
                    <h3>âŒ Error en Tests de StorageManager</h3>
                    <pre style="color: red;">${error.message}</pre>
                `;
            }
        }
        
        /**
         * ğŸ§ª Ejecutar suite de tests
         */
        function runTests() {
            // Abrir tests originales
            window.open('http://localhost:8000/src/tests/test-runner.html', '_blank');
            
            // TambiÃ©n mostrar tests de StorageManager si estÃ¡n disponibles
            if (typeof testSuite !== 'undefined') {
                console.log('ğŸ§ª Ejecutando tests de StorageManager en consola...');
                // Los tests se ejecutarÃ­an aquÃ­ si el framework estuviera cargado
            }
        }
        
        /**
         * ğŸ“Š Actualizar estado de un sistema
         */
        function updateSystemStatus(system, status, message) {
            const container = document.getElementById('systemStatus');
            let card = document.getElementById(`status-${system}`);
            
            if (!card) {
                card = document.createElement('div');
                card.className = 'status-card';
                card.id = `status-${system}`;
                container.appendChild(card);
            }
            
            const systemNames = {
                'app': 'ğŸš€ AplicaciÃ³n',
                'eventBus': 'ğŸ“¡ EventBus',
                'cache': 'ğŸ—„ï¸ Cache',
                'validation': 'âœ… Validation',
                'metrics': 'ğŸ“Š Metrics',
                'debug': 'ğŸ› Debug Mode'
            };
            
            card.innerHTML = `
                <h3>${systemNames[system] || system}</h3>
                <div>
                    <span class="status-indicator status-${status}"></span>
                    ${message}
                </div>
                <small style="color: #666;">Actualizado: ${new Date().toLocaleTimeString()}</small>
            `;
        }
        
        /**
         * ğŸ”„ Actualizar estado de todos los sistemas
         */
        function updateAllSystemStatus() {
            updateSystemStatus('eventBus', 'success', 'Sistema de eventos funcionando');
            updateSystemStatus('cache', 'success', 'Sistema de cachÃ© activo');
            updateSystemStatus('validation', 'success', 'Sistema de validaciÃ³n listo');
            updateSystemStatus('metrics', 'success', 'Sistema de mÃ©tricas recopilando');
        }
        
        // ğŸš€ InicializaciÃ³n automÃ¡tica del estado
        document.addEventListener('DOMContentLoaded', () => {
            updateSystemStatus('app', 'warning', 'No inicializada');
            updateAllSystemStatus();
            
            console.log(`
ğŸ”„ SISTEMA MIGRADO CARGADO (VersiÃ³n Simple)
==========================================

ğŸ› ï¸ Comandos disponibles en consola:
- initMigratedApp()    : Inicializar aplicaciÃ³n
- showMetrics()        : Ver mÃ©tricas
- showState()          : Ver estado
- testSystems()        : Probar sistemas
- clearCache()         : Limpiar cachÃ©
- runTests()           : Abrir suite de tests

ğŸ“± Usa los botones del panel de desarrollo en la esquina superior derecha.
            `);
        });
    </script>
</body>
</html>
