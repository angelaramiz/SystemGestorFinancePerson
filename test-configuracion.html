<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba - Modal de ConfiguraciÃ³n</title>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/ventanas.css">
</head>
<body>
    <div style="padding: 2rem;">
        <h1>ğŸ”§ Prueba del Sistema de ConfiguraciÃ³n</h1>
        <p>Esta pÃ¡gina prueba la funcionalidad del modal de configuraciÃ³n del sistema.</p>
        
        <div style="margin: 2rem 0;">
            <button id="configuracion" class="btn-primary">
                âš™ï¸ Abrir ConfiguraciÃ³n
            </button>
            <button id="test-formatear" class="btn-secondary">
                ğŸ’° Probar Formato de Moneda
            </button>
            <button id="test-config" class="btn-secondary">
                ğŸ“– Ver ConfiguraciÃ³n Actual
            </button>
        </div>
        
        <div id="resultados" style="background: #f8fafc; padding: 1rem; border-radius: 0.5rem; margin-top: 1rem;">
            <h3>ğŸ“Š Resultados de Pruebas:</h3>
            <div id="log-resultados"></div>
        </div>
    </div>

    <!-- Modal de ConfiguraciÃ³n -->
    <div id="modal-configuracion" class="modal">
        <div class="modal-content large">
            <div class="modal-header">
                <h2>âš™ï¸ ConfiguraciÃ³n del Sistema</h2>
                <button class="modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="config-tabs">
                    <button class="config-tab active" data-tab="general">ğŸŒ General</button>
                    <button class="config-tab" data-tab="moneda">ğŸ’° Moneda</button>
                    <button class="config-tab" data-tab="notificaciones">ğŸ”” Notificaciones</button>
                    <button class="config-tab" data-tab="interfaz">ğŸ¨ Interfaz</button>
                    <button class="config-tab" data-tab="datos">ğŸ“Š Datos</button>
                </div>

                <!-- PestaÃ±a General -->
                <div id="config-general" class="config-panel active">
                    <h3>ğŸŒ ConfiguraciÃ³n General</h3>
                    <div class="form-group">
                        <label for="config-idioma">Idioma del Sistema</label>
                        <select id="config-idioma">
                            <option value="es">EspaÃ±ol</option>
                            <option value="en">English</option>
                            <option value="pt">PortuguÃªs</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="config-formato-fecha">Formato de Fecha</label>
                        <select id="config-formato-fecha">
                            <option value="DD/MM/YYYY">DD/MM/YYYY</option>
                            <option value="MM/DD/YYYY">MM/DD/YYYY</option>
                            <option value="YYYY-MM-DD">YYYY-MM-DD</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="config-zona-horaria">Zona Horaria</label>
                        <select id="config-zona-horaria">
                            <option value="America/Mexico_City">Ciudad de MÃ©xico (GMT-6)</option>
                            <option value="America/New_York">Nueva York (GMT-5)</option>
                            <option value="Europe/Madrid">Madrid (GMT+1)</option>
                            <option value="America/Sao_Paulo">SÃ£o Paulo (GMT-3)</option>
                        </select>
                    </div>
                </div>

                <!-- PestaÃ±a Moneda -->
                <div id="config-moneda" class="config-panel">
                    <h3>ğŸ’° ConfiguraciÃ³n de Moneda</h3>
                    <div class="form-group">
                        <label for="config-moneda-principal">Moneda Principal</label>
                        <select id="config-moneda-principal">
                            <option value="MXN">ğŸ‡²ğŸ‡½ Peso Mexicano (MXN)</option>
                            <option value="USD">ğŸ‡ºğŸ‡¸ DÃ³lar Estadounidense (USD)</option>
                            <option value="EUR">ğŸ‡ªğŸ‡º Euro (EUR)</option>
                            <option value="GBP">ğŸ‡¬ğŸ‡§ Libra Esterlina (GBP)</option>
                            <option value="JPY">ğŸ‡¯ğŸ‡µ Yen JaponÃ©s (JPY)</option>
                            <option value="CAD">ğŸ‡¨ğŸ‡¦ DÃ³lar Canadiense (CAD)</option>
                            <option value="AUD">ğŸ‡¦ğŸ‡º DÃ³lar Australiano (AUD)</option>
                            <option value="BRL">ğŸ‡§ğŸ‡· Real BrasileÃ±o (BRL)</option>
                            <option value="ARS">ğŸ‡¦ğŸ‡· Peso Argentino (ARS)</option>
                            <option value="COP">ğŸ‡¨ğŸ‡´ Peso Colombiano (COP)</option>
                            <option value="CLP">ğŸ‡¨ğŸ‡± Peso Chileno (CLP)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="config-simbolo-moneda">SÃ­mbolo</label>
                        <input type="text" id="config-simbolo-moneda" placeholder="$" maxlength="3">
                    </div>
                    <div class="form-group">
                        <label for="config-decimales">Decimales</label>
                        <select id="config-decimales">
                            <option value="0">Sin decimales (1000)</option>
                            <option value="2">2 decimales (1000.00)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="config-separador-miles">Separador de Miles</label>
                        <select id="config-separador-miles">
                            <option value=",">,</option>
                            <option value=".">.  </option>
                            <option value=" ">espacio</option>
                            <option value="">ninguno</option>
                        </select>
                    </div>
                    <div class="preview-moneda">
                        <h4>Vista Previa:</h4>
                        <div id="preview-monto">$1,234.56</div>
                    </div>
                </div>

                <!-- PestaÃ±a Notificaciones -->
                <div id="config-notificaciones" class="config-panel">
                    <h3>ğŸ”” ConfiguraciÃ³n de Notificaciones</h3>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="config-notif-habilitadas" checked>
                            Habilitar notificaciones
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="config-notif-anticipacion">DÃ­as de anticipaciÃ³n para vencimientos</label>
                        <select id="config-notif-anticipacion">
                            <option value="1">1 dÃ­a</option>
                            <option value="3" selected>3 dÃ­as</option>
                            <option value="5">5 dÃ­as</option>
                            <option value="7">1 semana</option>
                            <option value="15">15 dÃ­as</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="config-notif-sonido" checked>
                            Reproducir sonido
                        </label>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="config-notif-browser" checked>
                            Notificaciones del navegador
                        </label>
                    </div>
                </div>

                <!-- PestaÃ±a Interfaz -->
                <div id="config-interfaz" class="config-panel">
                    <h3>ğŸ¨ ConfiguraciÃ³n de Interfaz</h3>
                    <div class="form-group">
                        <label for="config-tema">Tema</label>
                        <select id="config-tema">
                            <option value="claro">ğŸŒ Claro</option>
                            <option value="oscuro">ğŸŒ™ Oscuro</option>
                            <option value="auto">ğŸ”„ AutomÃ¡tico</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="config-color-primario">Color Primario</label>
                        <div class="color-options">
                            <input type="radio" name="color-primario" value="#2563eb" id="color-azul" checked>
                            <label for="color-azul" class="color-option" style="background: #2563eb"></label>
                            <input type="radio" name="color-primario" value="#059669" id="color-verde">
                            <label for="color-verde" class="color-option" style="background: #059669"></label>
                            <input type="radio" name="color-primario" value="#dc2626" id="color-rojo">
                            <label for="color-rojo" class="color-option" style="background: #dc2626"></label>
                            <input type="radio" name="color-primario" value="#7c3aed" id="color-morado">
                            <label for="color-morado" class="color-option" style="background: #7c3aed"></label>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="config-animaciones">Animaciones</label>
                        <select id="config-animaciones">
                            <option value="todas">Todas las animaciones</option>
                            <option value="reducidas">Animaciones reducidas</option>
                            <option value="ninguna">Sin animaciones</option>
                        </select>
                    </div>
                </div>

                <!-- PestaÃ±a Datos -->
                <div id="config-datos" class="config-panel">
                    <h3>ğŸ“Š ConfiguraciÃ³n de Datos</h3>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="config-autosave" checked>
                            Autoguardado automÃ¡tico
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="config-autosave-intervalo">Intervalo de autoguardado</label>
                        <select id="config-autosave-intervalo">
                            <option value="1">1 minuto</option>
                            <option value="5" selected>5 minutos</option>
                            <option value="10">10 minutos</option>
                            <option value="30">30 minutos</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="config-backup">Respaldo automÃ¡tico</label>
                        <select id="config-backup">
                            <option value="diario">Diario</option>
                            <option value="semanal" selected>Semanal</option>
                            <option value="mensual">Mensual</option>
                            <option value="manual">Solo manual</option>
                        </select>
                    </div>
                    <div class="data-actions">
                        <button class="btn-secondary" id="btn-limpiar-cache">ğŸ—‘ï¸ Limpiar Cache</button>
                        <button class="btn-secondary" id="btn-reset-config">ğŸ”„ Restaurar ConfiguraciÃ³n</button>
                        <button class="btn-danger" id="btn-borrar-datos">âš ï¸ Borrar Todos los Datos</button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-secondary modal-close">Cancelar</button>
                <button class="btn-primary" id="guardar-configuracion">ğŸ’¾ Guardar ConfiguraciÃ³n</button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/storage/localStorage.js"></script>
    <script src="js/storage/indexedDB.js"></script>
    <script src="js/models/Ingreso.js"></script>
    <script src="js/models/Gasto.js"></script>
    <script src="js/utils/notificaciones.js"></script>
    <script src="js/utils/configuracion.js"></script>

    <script>
        // FunciÃ³n para agregar log de resultados
        function agregarLog(mensaje, tipo = 'info') {
            const logDiv = document.getElementById('log-resultados');
            const timestamp = new Date().toLocaleTimeString();
            const color = tipo === 'success' ? '#10b981' : tipo === 'error' ? '#ef4444' : '#2563eb';
            
            logDiv.innerHTML += `<div style="color: ${color}; margin: 0.5rem 0;">[${timestamp}] ${mensaje}</div>`;
        }

        // Inicializar cuando se cargue la pÃ¡gina
        document.addEventListener('DOMContentLoaded', async () => {
            agregarLog('ğŸ”„ Inicializando sistema de configuraciÃ³n...');
            
            try {
                // Inicializar managers de almacenamiento
                if (window.localStorageManager) {
                    window.localStorageManager.init();
                    agregarLog('âœ… LocalStorageManager inicializado', 'success');
                }

                if (window.indexedDBManager) {
                    await window.indexedDBManager.init();
                    agregarLog('âœ… IndexedDBManager inicializado', 'success');
                }

                // Crear manager de notificaciones bÃ¡sico
                if (!window.NotificacionesManager) {
                    window.NotificacionesManager = {
                        mostrar: function(mensaje, tipo) {
                            console.log(`[${tipo.toUpperCase()}] ${mensaje}`);
                            agregarLog(`ğŸ“¢ ${mensaje}`, tipo);
                        }
                    };
                }

                // Inicializar configuraciÃ³n
                if (window.ConfiguracionManager) {
                    await window.ConfiguracionManager.inicializar();
                    agregarLog('âœ… ConfiguracionManager inicializado', 'success');
                } else {
                    agregarLog('âŒ ConfiguracionManager no encontrado', 'error');
                }

                // Configurar eventos de prueba
                document.getElementById('test-formatear').addEventListener('click', () => {
                    const monto = 1234567.89;
                    const formateado = window.formatearMoneda ? window.formatearMoneda(monto) : `$${monto}`;
                    agregarLog(`ğŸ’° Formato de moneda: ${formateado}`, 'success');
                });

                document.getElementById('test-config').addEventListener('click', () => {
                    const config = window.obtenerConfiguracionMoneda ? window.obtenerConfiguracionMoneda() : {};
                    agregarLog(`ğŸ“– ConfiguraciÃ³n actual: ${JSON.stringify(config)}`, 'info');
                });

                agregarLog('âœ… Sistema inicializado completamente', 'success');

            } catch (error) {
                agregarLog(`âŒ Error al inicializar: ${error.message}`, 'error');
                console.error('Error:', error);
            }
        });
    </script>
</body>
</html>
